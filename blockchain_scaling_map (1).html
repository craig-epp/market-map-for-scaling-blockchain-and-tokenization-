<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Collaborative Blockchain Scaling Ecosystem Map</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            color: #ffffff;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            position: relative;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        h1 {
            font-size: 2.5em;
            background: linear-gradient(45deg, #00d4ff, #ff6b6b, #4ecdc4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }
        
        .collaboration-notice {
            background: rgba(0, 212, 255, 0.1);
            border: 1px solid rgba(0, 212, 255, 0.3);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            background: rgba(0, 212, 255, 0.2);
            color: white;
            border: 1px solid rgba(0, 212, 255, 0.5);
        }
        
        .btn:hover {
            background: rgba(0, 212, 255, 0.4);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 212, 255, 0.3);
        }
        
        .btn.secondary {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.3);
        }
        
        .map-container {
            position: relative;
            height: 800px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            overflow: hidden;
        }
        
        .layer {
            position: absolute;
            border-radius: 15px;
            padding: 15px;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .layer:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(0, 212, 255, 0.3);
            border-color: rgba(0, 212, 255, 0.5);
        }
        
        .layer h3 {
            margin: 0 0 10px 0;
            font-size: 1.2em;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .add-btn {
            font-size: 0.8em;
            padding: 5px 10px;
            background: rgba(0, 255, 0, 0.2);
            border: 1px solid rgba(0, 255, 0, 0.5);
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .add-btn:hover {
            background: rgba(0, 255, 0, 0.4);
        }
        
        .companies {
            font-size: 0.9em;
            opacity: 0.9;
            line-height: 1.4;
        }
        
        .company {
            display: inline-block;
            margin: 2px 4px;
            padding: 3px 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            font-size: 0.8em;
            position: relative;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .company:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-1px);
        }
        
        .company.new {
            background: rgba(0, 255, 0, 0.2);
            border: 1px solid rgba(0, 255, 0, 0.5);
        }
        
        .company.pending {
            background: rgba(255, 193, 7, 0.2);
            border: 1px solid rgba(255, 193, 7, 0.5);
        }
        
        /* Layer positioning and colors - same as before */
        .l1-scaling {
            top: 50px;
            left: 50px;
            width: 280px;
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.2), rgba(255, 107, 107, 0.05));
        }
        
        .infrastructure {
            top: 50px;
            right: 50px;
            width: 300px;
            background: linear-gradient(135deg, rgba(78, 205, 196, 0.2), rgba(78, 205, 196, 0.05));
        }
        
        .enterprise {
            top: 250px;
            left: 50px;
            width: 280px;
            background: linear-gradient(135deg, rgba(255, 193, 7, 0.2), rgba(255, 193, 7, 0.05));
        }
        
        .tokenization {
            top: 250px;
            right: 50px;
            width: 300px;
            background: linear-gradient(135deg, rgba(156, 39, 176, 0.2), rgba(156, 39, 176, 0.05));
        }
        
        .user-experience {
            bottom: 50px;
            left: 50%;
            transform: translateX(-50%);
            width: 350px;
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.2), rgba(0, 212, 255, 0.05));
        }
        
        .core-blockchain {
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 200px;
            height: 120px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0.05));
            border: 2px solid rgba(0, 212, 255, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
        
        /* Connection lines - same as before */
        .connection {
            position: absolute;
            height: 2px;
            background: linear-gradient(90deg, transparent, rgba(0, 212, 255, 0.5), transparent);
            animation: pulse 2s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }
        
        .conn1 { top: 150px; left: 330px; width: 120px; transform: rotate(20deg); }
        .conn2 { top: 150px; right: 350px; width: 120px; transform: rotate(-20deg); }
        .conn3 { top: 350px; left: 330px; width: 120px; transform: rotate(-20deg); }
        .conn4 { top: 350px; right: 350px; width: 120px; transform: rotate(20deg); }
        .conn5 { bottom: 200px; left: 50%; width: 100px; transform: translateX(-50%) rotate(90deg); }
        
        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
        }
        
        .modal-content {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            margin: 5% auto;
            padding: 30px;
            border-radius: 20px;
            width: 90%;
            max-width: 600px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .modal h2 {
            margin-top: 0;
            color: #00d4ff;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #ffffff;
        }
        
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: #ffffff;
            font-size: 16px;
            box-sizing: border-box;
        }
        
        .form-group input::placeholder, .form-group textarea::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }
        
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            line-height: 1;
        }
        
        .close:hover {
            color: #fff;
        }
        
        .legend {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.5);
            padding: 15px;
            border-radius: 10px;
            font-size: 0.9em;
        }
        
        .legend-item {
            margin: 5px 0;
            display: flex;
            align-items: center;
        }
        
        .legend-color {
            width: 20px;
            height: 12px;
            border-radius: 6px;
            margin-right: 10px;
        }
        
        .stats {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.7);
            padding: 15px;
            border-radius: 10px;
            max-width: 250px;
        }
        
        .export-section {
            margin-top: 20px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            text-align: center;
        }
        
        @media (max-width: 768px) {
            .layer {
                position: static;
                width: 100% !important;
                margin: 10px 0;
                transform: none !important;
            }
            
            .map-container {
                height: auto;
                padding: 20px;
            }
            
            .core-blockchain, .connection {
                display: none;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Collaborative Blockchain Scaling Ecosystem</h1>
            <div class="collaboration-notice">
                🤝 <strong>Community-Driven Map</strong> • Add companies, suggest categories, export data for GitHub collaboration
            </div>
        </div>
        
        <div class="controls">
            <button class="btn" onclick="showAddCompanyModal()">+ Add Company</button>
            <button class="btn secondary" onclick="showAddCategoryModal()">+ New Category</button>
            <button class="btn secondary" onclick="exportData()">📥 Export JSON</button>
            <button class="btn secondary" onclick="importData()">📤 Import Data</button>
            <button class="btn secondary" onclick="generateGitHubReadme()">📋 Generate README</button>
        </div>
        
        <div class="stats">
            <h4>📊 Map Statistics</h4>
            <p><strong id="totalCompanies">0</strong> companies across <strong id="totalCategories">5</strong> categories</p>
            <p><strong id="pendingCount">0</strong> pending additions</p>
            <p>Last updated: <span id="lastUpdated">Now</span></p>
        </div>
        
        <div class="map-container" id="mapContainer">
            <!-- Content will be generated by JavaScript -->
        </div>
        
        <div class="legend">
            <h4>Legend</h4>
            <div class="legend-item">
                <div class="legend-color" style="background: rgba(0, 255, 0, 0.5);"></div>
                <span>New Addition</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: rgba(255, 193, 7, 0.5);"></div>
                <span>Pending Review</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: rgba(255, 255, 255, 0.2);"></div>
                <span>Established</span>
            </div>
        </div>
        
        <div class="export-section">
            <h3>🚀 Ready to Collaborate?</h3>
            <p>Export your changes as JSON, create a GitHub repo, and invite industry experts to contribute!</p>
            <button class="btn" onclick="showCollaborationGuide()">📚 Collaboration Guide</button>
        </div>
    </div>

    <!-- Add Company Modal -->
    <div id="addCompanyModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('addCompanyModal')">&times;</span>
            <h2>Add New Company</h2>
            <form id="addCompanyForm">
                <div class="form-group">
                    <label for="companyName">Company Name *</label>
                    <input type="text" id="companyName" required placeholder="e.g., LayerZero">
                </div>
                <div class="form-group">
                    <label for="companyCategory">Category *</label>
                    <select id="companyCategory" required>
                        <option value="">Select a category</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="companyDescription">Description</label>
                    <textarea id="companyDescription" placeholder="Brief description of what the company does"></textarea>
                </div>
                <div class="form-group">
                    <label for="companyWebsite">Website</label>
                    <input type="url" id="companyWebsite" placeholder="https://company.com">
                </div>
                <div class="form-group">
                    <label for="contributorName">Your Name/Organization</label>
                    <input type="text" id="contributorName" placeholder="For attribution">
                </div>
                <button type="submit" class="btn">Add Company</button>
            </form>
        </div>
    </div>

    <!-- Add Category Modal -->
    <div id="addCategoryModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('addCategoryModal')">&times;</span>
            <h2>Add New Category</h2>
            <form id="addCategoryForm">
                <div class="form-group">
                    <label for="categoryName">Category Name *</label>
                    <input type="text" id="categoryName" required placeholder="e.g., DeFi Infrastructure">
                </div>
                <div class="form-group">
                    <label for="categoryDescription">Description *</label>
                    <textarea id="categoryDescription" required placeholder="What types of companies belong in this category?"></textarea>
                </div>
                <div class="form-group">
                    <label for="categoryColor">Theme Color</label>
                    <input type="color" id="categoryColor" value="#4ecdc4">
                </div>
                <button type="submit" class="btn">Add Category</button>
            </form>
        </div>
    </div>

    <script>
        // Initial ecosystem data
        let ecosystemData = {
            categories: {
                'l1-scaling': {
                    name: '⚡ Layer 2 & Scaling',
                    description: 'Zero-knowledge rollups, optimistic rollups, state channels',
                    color: '#ff6b6b',
                    position: { top: '50px', left: '50px', width: '280px' },
                    companies: ['Polygon', 'Arbitrum', 'Optimism', 'StarkNet', 'zkSync', 'Lightning Network', 'Immutable X']
                },
                'infrastructure': {
                    name: '🏗️ Infrastructure & Tools',
                    description: 'Node providers, bridges, oracles, development tools',
                    color: '#4ecdc4',
                    position: { top: '50px', right: '50px', width: '300px' },
                    companies: ['Infura', 'Alchemy', 'QuickNode', 'Chainlink', 'LayerZero', 'Wormhole', 'The Graph']
                },
                'enterprise': {
                    name: '🏢 Enterprise Integration',
                    description: 'Blockchain-as-a-Service, compliance, enterprise adoption',
                    color: '#ffc107',
                    position: { top: '250px', left: '50px', width: '280px' },
                    companies: ['AWS Blockchain', 'Microsoft Azure', 'IBM Blockchain', 'ConsenSys', 'R3 Corda', 'Hyperledger']
                },
                'tokenization': {
                    name: '🪙 Tokenization Infrastructure',
                    description: 'Asset digitization, custody, fractional ownership',
                    color: '#9c27b0',
                    position: { top: '250px', right: '50px', width: '300px' },
                    companies: ['Centrifuge', 'Polymath', 'tZERO', 'Securitize', 'Harbor', 'Templum', 'Tokensoft']
                },
                'user-experience': {
                    name: '👤 User Experience Layer',
                    description: 'Wallets, gasless transactions, user onboarding',
                    color: '#00d4ff',
                    position: { bottom: '50px', left: '50%', transform: 'translateX(-50%)', width: '350px' },
                    companies: ['MetaMask', 'WalletConnect', 'Magic', 'Coinbase Wallet', 'Argent', 'Gnosis Safe', 'Biconomy']
                }
            },
            metadata: {
                lastUpdated: new Date().toISOString(),
                contributors: [],
                version: '1.0.0'
            }
        };

        // Load data from localStorage if available
        const savedData = localStorage.getItem('blockchainEcosystemData');
        if (savedData) {
            try {
                ecosystemData = { ...ecosystemData, ...JSON.parse(savedData) };
            } catch (e) {
                console.warn('Failed to load saved data');
            }
        }

        function saveData() {
            ecosystemData.metadata.lastUpdated = new Date().toISOString();
            localStorage.setItem('blockchainEcosystemData', JSON.stringify(ecosystemData));
            renderMap();
            updateStats();
        }

        function renderMap() {
            const mapContainer = document.getElementById('mapContainer');
            mapContainer.innerHTML = `
                <div class="connection conn1"></div>
                <div class="connection conn2"></div>
                <div class="connection conn3"></div>
                <div class="connection conn4"></div>
                <div class="connection conn5"></div>
                <div class="layer core-blockchain">
                    <h3>⛓️ Core Blockchain</h3>
                    <p>Ethereum, Bitcoin<br>Layer 1 Networks</p>
                </div>
            `;

            Object.entries(ecosystemData.categories).forEach(([key, category]) => {
                const layerDiv = document.createElement('div');
                layerDiv.className = `layer ${key}`;
                layerDiv.style.cssText = Object.entries(category.position)
                    .map(([prop, value]) => `${prop}: ${value}`)
                    .join('; ');
                layerDiv.style.background = `linear-gradient(135deg, ${category.color}33, ${category.color}0d)`;

                const companiesHtml = category.companies.map(company => {
                    const companyClass = typeof company === 'object' ? 
                        (company.status === 'new' ? 'company new' : 'company pending') : 'company';
                    const companyName = typeof company === 'object' ? company.name : company;
                    return `<span class="${companyClass}" onclick="editCompany('${key}', '${companyName}')">${companyName}</span>`;
                }).join('');

                layerDiv.innerHTML = `
                    <h3>
                        ${category.name}
                        <button class="add-btn" onclick="showAddCompanyModal('${key}')">+ Add</button>
                    </h3>
                    <div class="companies">
                        ${companiesHtml}
                    </div>
                `;

                mapContainer.appendChild(layerDiv);
            });

            // Populate category dropdown
            const categorySelect = document.getElementById('companyCategory');
            categorySelect.innerHTML = '<option value="">Select a category</option>';
            Object.entries(ecosystemData.categories).forEach(([key, category]) => {
                const option = document.createElement('option');
                option.value = key;
                option.textContent = category.name;
                categorySelect.appendChild(option);
            });
        }

        function updateStats() {
            const totalCompanies = Object.values(ecosystemData.categories)
                .reduce((sum, cat) => sum + cat.companies.length, 0);
            const totalCategories = Object.keys(ecosystemData.categories).length;
            const pendingCount = Object.values(ecosystemData.categories)
                .reduce((sum, cat) => sum + cat.companies.filter(c => 
                    typeof c === 'object' && (c.status === 'new' || c.status === 'pending')).length, 0);

            document.getElementById('totalCompanies').textContent = totalCompanies;
            document.getElementById('totalCategories').textContent = totalCategories;
            document.getElementById('pendingCount').textContent = pendingCount;
            document.getElementById('lastUpdated').textContent = new Date(ecosystemData.metadata.lastUpdated).toLocaleDateString();
        }

        function showAddCompanyModal(categoryKey = '') {
            document.getElementById('companyCategory').value = categoryKey;
            document.getElementById('addCompanyModal').style.display = 'block';
        }

        function showAddCategoryModal() {
            document.getElementById('addCategoryModal').style.display = 'block';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        function exportData() {
            const dataStr = JSON.stringify(ecosystemData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'blockchain-ecosystem-data.json';
            link.click();
            URL.revokeObjectURL(url);
        }

        function importData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = function(event) {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            const importedData = JSON.parse(e.target.result);
                            ecosystemData = { ...ecosystemData, ...importedData };
                            saveData();
                            alert('Data imported successfully!');
                        } catch (error) {
                            alert('Error importing data: ' + error.message);
                        }
                    };
                    reader.readAsText(file);
                }
            };
            input.click();
        }

        function generateGitHubReadme() {
            const readme = `# Blockchain Scaling Ecosystem Map

## Overview
A collaborative map of tools and companies essential for blockchain and tokenization to scale logarithmically.

## Categories

${Object.entries(ecosystemData.categories).map(([key, category]) => `
### ${category.name}
${category.description}

**Companies:** ${category.companies.map(c => typeof c === 'object' ? c.name : c).join(', ')}
`).join('')}

## Contributing

1. Fork this repository
2. Update the \`ecosystem-data.json\` file
3. Submit a pull request with your changes
4. Include rationale for additions/changes

## Data Structure

\`\`\`json
${JSON.stringify(ecosystemData, null, 2)}
\`\`\`

## Statistics
- **Total Companies:** ${Object.values(ecosystemData.categories).reduce((sum, cat) => sum + cat.companies.length, 0)}
- **Categories:** ${Object.keys(ecosystemData.categories).length}
- **Last Updated:** ${new Date(ecosystemData.metadata.lastUpdated).toLocaleDateString()}

## License
MIT License - Feel free to use and modify for educational and commercial purposes.
`;

            const blob = new Blob([readme], { type: 'text/markdown' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'README.md';
            link.click();
            URL.revokeObjectURL(url);
        }

        function showCollaborationGuide() {
            alert(`🚀 Collaboration Guide:

1. Export JSON Data - Download your ecosystem data
2. Create GitHub Repository - Upload JSON + HTML files
3. Enable GitHub Pages - For live preview
4. Share Repository - Invite industry experts
5. Use Issues/PRs - For structured collaboration
6. Regular Updates - Sync changes back to map

GitHub repo structure:
├── index.html (this visualization)
├── ecosystem-data.json (company data)
├── README.md (generated documentation)
└── CONTRIBUTING.md (contribution guidelines)`);
        }

        // Form submissions
        document.getElementById('addCompanyForm').onsubmit = function(e) {
            e.preventDefault();
            const formData = new FormData(e.target);
            const categoryKey = formData.get('companyCategory');
            const companyName = formData.get('companyName');
            
            const companyData = {
                name: companyName,
                description: formData.get('companyDescription'),
                website: formData.get('companyWebsite'),
                status: 'new',
                addedBy: formData.get('contributorName'),
                addedDate: new Date().toISOString()
            };

            ecosystemData.categories[categoryKey].companies.push(companyData);
            saveData();
            closeModal('addCompanyModal');
            e.target.reset();
            alert(`${companyName} added successfully!`);
        };

        document.getElementById('addCategoryForm').onsubmit = function(e) {
            e.preventDefault();
            const formData = new FormData(e.target);
            const categoryKey = formData.get('categoryName').toLowerCase().replace(/\s+/g, '-');
            
            ecosystemData.categories[categoryKey] = {
                name: formData.get('categoryName'),
                description: formData.get('categoryDescription'),
                color: formData.get('categoryColor'),
                position: { bottom: '100px', left: '20px', width: '300px' },
                companies: []
            };
            
            saveData();
            closeModal('addCategoryModal');
            e.target.reset();
            alert('Category added successfully!');
        };

        // Close modals when clicking outside
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
            }
        };

        // Initialize
        renderMap();
        updateStats();
    </script>
</body>
</html>